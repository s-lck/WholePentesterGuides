# 389/636 - LDAP



If binding is allowed, gather information about the directory, it could contain confidential information as NT password or username

* `sudo nmap -sC -p 389 -vvv --script ldap-search <IP>`
* Check anonymous LDAP authentication : `ldapsearch -x -h <IP>`
  * `ldapsearch -h <IP> -p <PORT> -x -s base -b '' "(objectClass=*)" "*" +`
  * `ldapsearch -h <IP> -p <PORT> -x -s base -b "ou=<OU>,dc=<DC>,dc=<DC>,dc=<DC>"`
* `Softerra LDAP Browser`
* Get the root DSE : `ldapsearch -x -h <IP> -s base namingcontexts`
  * RootDSE est défini comme la racine de l'arborescence de données sur un serveur d'annuaire
  * `ldapsearch -h <IP> -x -b "dc=<DC>,dc=<DC>"`
    * sambaNTPassword : MD4 hash, which is a hashing algorithm broken for over a decade.
      * Can be used to authenticate on SMB with smbclient for example
    * userPassword
      * `base64 -d <userPassword>` : `{HASH-ALGO}$<X>$<XXX>$<XXXXX>`
        * Remove `{HASH-ALGO}` and use `hashcat` or `john`
