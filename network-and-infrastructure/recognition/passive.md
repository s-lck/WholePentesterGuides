# Passive

### **Listen the network passively**

Check the different kind of protocol\
Gather information about the current sub network as IP range, the gateway, the DNS server ...

* `wireshark` or `tcpdump`
  * In the point to limit the noise producted by your own device:
    * Disable your network: `sudo service network-manager stop`
    * Kill the dhclient process: `sudo ps aux |grep dhc`
    * Flush your interface: `sudo ip addr flush <INTERFACE>`
  * If there is a DHCP server:
    * `sudo dhclient -i <INTERFACE> -v`
  *   If there is no DHCP server:

      * Update `sudo vi /etc/network/interfaces` to set a fixed IP
      * Set the configuration to set your IP:

      ```
         auto <INTERFACE>
         iface <INTERFACE> inet static
         address <IP>
         netmask <MASK>
         gateway <GW>
      ```

      * `sudo service network-manager restart`
      * `sudo service networking restart`
  * Other way to set a static IP : `sudo ifconfig eth0 <IP> netmask <MASK>`
  * To set a DNS : `/etc/resolv.conf`
  * To delete a route : `sudo route del -net <IP> gw <GW> netmask <MASK>`

### **Set up a DHCP locally**

* `/etc/network/interfaces`

```
# eth0
auto eth0
iface eth0 inet static
address <IP>
netmask <MASK>
network <NETWORK>
broadcast <BROADCAST>
gateway <GW>
```

* `/etc/dhcp/dhcpd.conf`

```
	option domain-name "example.org";
	option domain-name-servers <IP-DNS1>, <IP-DNS2>;

	default-lease-time 600;
	max-lease-time 7200;

	subnet <NETWORK> netmask <MASK> {
	range <IP-MINIMUM> <IP-MAXIMUM>;
	option subnet-mask <MASK>;
	option broadcast-address <BROADCAST>;
	option routers <GW>;
	}
```

* `sudo /etc/init.d/isc-dhcp-server restart`
* `sudo /etc/init.d/isc-dhcp-server status`
