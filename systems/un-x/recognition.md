# Recognition

## M**anually**

Due to the expending Unix world the information gathering process could be different owing to different shell commands.

* [https://www.rebootuser.com/?p=1623](https://www.rebootuser.com/?p=1623)
* [https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)

Generic commands:

* Operating system full version: `uname -a` ; `cat /proc/version` ; `cat /etc/*-release` ; `lsb_release -a`
* Shared object dependencies : `ldd --version`
* Current user: `id`
* Local users: `cat /etc/passwd`
* Local groups: `cat /etc/group`
* Logged users: `users`, `who -u`,`w`
* Is the device belong to a domain: WiP
* Environment variables : `env` to display one `echo ${<ENV>}`
* Sudoers file : `/etc/sudoers` ; `sudo -u <USERNAME> bash`
* Fichiers SUID : `find / -perm -4000 -type f 2>/dev/null`
  * Use [GTFO bins](https://gtfobins.github.io/gtfobins)
* Liste les commandes autoris√©es pour l'utilisateur courant : `sudo -l`
  * Use GTFO bins
* Display old command : `.bash_history`
* Display capabilities :
  * `getcap *`
  * `getcap <FILE>`
  * `getcap -r / 2>/dev/null`
* IP and interfaces configuration: `ifconfig -a`
* Route configuration: `route`
* ARP table: `arp`
* Shares: WiP
* Network connections: `netstat -laputen`
* Iptables :
  * `/etc/iptables/rules.v4`
  * `/etc/iptables/rules.v6`
* Look for port knocking
  * Service `knockd`
  * `/etc/knockd.conf`
* Running processes and services: `ps -aux`
  * `ps -eo command`
* Installed programs
* Check crontab : `crontab -l`
* Files and directories enumeration
* Check for non default root directories : `ls -l /`
  * Examples : backups, data, report ...
* Group access : `find / -group <GROUP_NAME> 2>/dev/null`
* Keytab files : `find / -iname "*\.keytab" -perm -o+r 2> /dev/null`
  * List keylist in a keytab file : `klist -kt <FILE>.keytab`
* Mounted file system : `cat /proc/mount`
  * It is possible to mount partition with `nosuid` to block suid bit on binaries
* Looking for password
* Configuration file in /etc/\*.conf (sshd, httpd, ldapd ...)
  * sshd
    *   Certification authority

        ```
        AuthorizedKeysCommand /usr/local/bin/curl http://127.0.0.1/sshauth?type=keys&username=%u
        TrustedUserCAKeys /home/userca/ca.pub
        AuthorizedPrincipalsCommand /usr/local/bin/curl http://127.0.0.1/sshauth?type=principals&username=%u
        ```
  * Get authrozed keys : `cat authorized_keys`
* Web application configuration file :
  * `/usr/share/tomcat7/conf/tomcat-users.xml`
* Chercher PWD dans fichier (casser MDP VNC : [https://github.com/jeroennijhof/vncpwd)\\](https://github.com/jeroennijhof/vncpwd\)/) \\
* Is mysql running in root without password : `mysql -h localhost -u root -p`

Specific commands:

* Debian
  * Apache config file : `/etc/apache2/apache2.conf` - `/etc/apache2/sites-available/default`
* RedHat (systemctl status firewalld.service)
* AIX
* FreeBSD
  * Apache config file : `/usr/local/etc/apache22/httpd.conf`
  * Apache log file : /var/log/httpd-access.log
  * Use `fetch` to download files
* OpenBSD
  *   The sudo alternative in openbsd is doas

      * cat /etc/doas.conf

      ```
      permit nopass <USER_1> as <USER_2> cmd <COMMAND>
      ```

## **Automatically**

* **Linux Smart Enumeration**
  * `wget "https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh" -O lse.sh`
  * `curl "https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh" -o lse.sh`
    * `./lse.sh`
      * There is 3 different level of verbosity `-l0` (default), `-l1`, `-l2`
* **BeRoot for Linux**: On the remote machine do `git clone https://github.com/AlessandroZ/BeRoot.git` then `python beroot.py`
* **LinEnum**: On the target machine do `./LinEnum.sh -r report -e /tmp/ -t`
* **pspy**: [https://github.com/DominicBreuker/pspy](https://github.com/DominicBreuker/pspy)
  * Releases: [https://github.com/DominicBreuker/pspy/releases](https://github.com/DominicBreuker/pspy/releases)
  * Command line tool designed to snoop on processes without need for root permissions
* Find exploits available kernel exploit:
  * **Linux Exploit Suggester**: On the target machine do `uname -a` then `dpkg -l`, and in your own machine do `./linux-exploit-suggester.sh --uname <UNAME_OUTPUT> --pkglist-file <DPKG_OUTPUT>`
