# 5985 - WinRM

Windows Remote Management (WinRM) is a feature of Windows Vista that allows administrators to remotely run management scripts.

`auxiliary(scanner/winrm/winrm_login`

`auxiliary(scanner/winrm/winrm_auth_methods`



[https://github.com/Hackplayers/evil-winrm](https://github.com/Hackplayers/evil-winrm)

* evil-winrm -i -u -p ''
  * To upload file on the target: `upload <FILE>`
  * To download file on the target: `download <FILE>`
  * Use `-s` to specify a path of a folder containing powershell scripts, then in the session type powershell script name to execute it on the target
    * The scripts have to be already in the folder before running the script
  * Then `menu` to see the all functions available



* Install on Kali : `sudo gem install -r wirm`

```ruby
require 'winrm'

conn = WinRM::Connection.new( 
  endpoint: 'http://<IP>:<PORT>/wsman',
  user: '<DOMAIN>\<USER>',
  password: '<PASSWORD>',
)

command=""

conn.shell(:powershell) do |shell|
    until command == "exit\n" do
        print "PS > "
        command = gets        
        output = shell.run(command) do |stdout, stderr|
            STDOUT.print stdout
            STDERR.print stderr
        end
    end    
    puts "Exiting with code #{output.exitcode}"
end
```

* Start the script on Kali : `ruby winrm-shell.rb`
