# 53 - DNS

When DNS is on **TCP **you need to test for zone transfer (identify hosts and possibly virtual hosts)

* `dig axfr @<IP-TARGET> <DOMAIN-TARGET>`
  * `dig axfr . @<IP>`
* `host -t axfr <DOMAIN-TARGET> <IP-TARGET>`

On **UDP**

* BIND
  * `dig version.bind txt -c chaos @<IP> +norecurse`
  * `dig hostname.bind txt -c chaos @<IP> +norecurse`
* Cache snooping
  * Initial request : `dig <EXAMPLE_DOMAIN> @<IP> -p <DNS_PORT> +norecurse`
    * Non-recursive queries instruct the DNS server not to contact another DNS server
    * `<EXAMPLE_DOMAIN>` is not resolved by the DNS server
  * Second request : `dig <EXAMPLE_DOMAIN> @<IP> -p <DNS_PORT>`
    * Entry is now present in the DNS cache
  * Last request : `dig <EXAMPLE_DOMAIN> @<IP> -p <DNS_PORT> +norecurse`
    * We can determine if another Wi-Fi user visited a specific website by trying to resolve `<EXAMPLE_DOMAIN>` with `+norecurse`
* DNS tunneling is possible if you can perform DNS requests through a Wi-Fi without purchase any data plan
  * Setting up a DNS server as primary DNS server for a dedicated domain
  * Then, the DNS server may be used to route Internet traffic
    * Network flow is encapsulated in DNS queries and responses
    * Packets are fragmented/encoded in DNS queries/responses, then decoded/routed on the Internet by the malicious DNS server

**``**

**``**
